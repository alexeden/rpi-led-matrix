<!DOCTYPE html><html class="default" lang="en" data-base="."><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>rpi-led-matrix</title><meta name="description" content="Documentation for rpi-led-matrix"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script defer src="assets/main.js"></script><script async src="assets/icons.js" id="tsd-icons-script"></script><script async src="assets/search.js" id="tsd-search-script"></script><script async src="assets/navigation.js" id="tsd-nav-script"></script><script async src="assets/hierarchy.js" id="tsd-hierarchy-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search"><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">rpi-led-matrix</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><h1>rpi-led-matrix</h1></div><div class="tsd-panel tsd-typography"><p><a href="https://github.com/alexeden/rpi-led-matrix/actions/workflows/raspberry-pi-3-build.yml"><img src="https://github.com/alexeden/rpi-led-matrix/actions/workflows/raspberry-pi-3-build.yml/badge.svg?style=flat-square" alt="Build - Raspberry Pi 3"></a>
<img src="https://img.shields.io/npm/v/rpi-led-matrix/latest" alt="npm version">
<img src="https://img.shields.io/npm/types/rpi-led-matrix" alt="types">
<img src="https://img.shields.io/librariesio/release/npm/rpi-led-matrix?logoColor=white" alt="dependencies">
<img src="https://img.shields.io/node/v/rpi-led-matrix?logo=node.js&amp;logoColor=white" alt="node version"></p>
<a id="raspberry-pi-led-matrix" class="tsd-anchor"></a><h1 class="tsd-anchor-link">Raspberry Pi LED Matrix<a href="#raspberry-pi-led-matrix" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h1><p>Control an RGB LED matrix connected to a Raspberry Pi using using Node.js. This library is a Node/Typescript binding of the brilliant <a href="https://github.com/hzeller/rpi-rgb-led-matrix">hzeller/rpi-rgb-led-matrix</a> library, plus some additional functionality. Builds on some of the mechanisms implemented by <a href="https://github.com/easybotics/node-rpi-rgb-led-matrix">easybotics/node-rpi-rgb-led-matrix</a> for double-buffering bitframes to get silky-smooth rendering.</p>
<ul>
<li><a href="#features">Features</a></li>
<li><a href="#installation-and-usage">Installation and Usage</a></li>
<li><a href="#getting-started">Getting Started</a>
<ul>
<li><a href="#the-bare-minimum">The bare minimum</a></li>
</ul>
</li>
<li><a href="#configuration">Configuration Options</a>
<ul>
<li><a href="#matrix-options">Matrix options</a></li>
<li><a href="#runtime-options">Runtime options</a></li>
</ul>
</li>
<li><a href="#drawing">Drawing</a>
<ul>
<li><a href="#usage-patterns">Usage Patterns</a></li>
<li><a href="#sync-hook">Sync Hook</a></li>
</ul>
</li>
<li><a href="#running--examples">Running /examples</a>
<ul>
<li><a href="#using-your-own-config">Using your own config</a></li>
</ul>
</li>
<li><a href="#api">API</a>
<ul>
<li><a href="#configuration-option-enums">Configuration option enums</a></li>
<li><a href="#configuration-interfaces">Configuration interfaces</a>
<ul>
<li><a href="#-ledmatrixutils-"><code>LedMatrixUtils</code></a></li>
<li><a href="#-font--and--ledmatrix-"><code>Font</code> and <code>LedMatrix</code></a></li>
<li><a href="#-layoututils-"><code>LayoutUtils</code></a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#developing-locally">Developing Locally</a></li>
</ul>
<p>Click the image below (links to a video) to see what this library can empower you to easily create:</p>
<p><a href="https://apemedia.s3.us-east-2.amazonaws.com/matrix+3-28-19.mp4"><img src="media/demo-thumbnail.png" alt="full demo"><em>This sequence is available in <code>examples/kitchen-sink.ts</code></em></a></p>
<a id="features" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Features<a href="#features" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><ul>
<li>Uses <a href="https://nodejs.org/api/n-api.html">N-API</a> to wrap the native code, so there's no risk of breakages with future Node.js version upgrades.</li>
<li>One-to-one mapping of both <a href="https://nodejs.org/api/n-api.html">matrix and runtime configuration options/flags</a> exposed by native library.</li>
<li><strong>Configuration options and API are fully documented in source and typed in TypeScript.</strong> Getting configured and up and running should be a breeze with the help of the provided enums and type checking.</li>
<li>Includes a set of utility methods for displaying text with a specified vertical and horizontal alignment.</li>
</ul>
<a id="installation-and-usage" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Installation and Usage<a href="#installation-and-usage" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Install the package:</p>
<pre><code><span class="hl-0">$</span><span class="hl-1"> </span><span class="hl-0">npm</span><span class="hl-1"> </span><span class="hl-0">install</span><span class="hl-1"> --</span><span class="hl-0">save</span><span class="hl-1"> </span><span class="hl-0">rpi</span><span class="hl-1">-</span><span class="hl-0">led</span><span class="hl-1">-</span><span class="hl-0">matrix</span>
</code><button>Copy</button></pre>

<blockquote>
<p><strong>Note</strong> If you're installing the package on a machine that isn't a Raspberry Pi, you'll get warnings from <code>node-gyp</code> that the compilation of the addon module is being skipped. This is to be expected. The warnings will disappear when the package is installed on an actual Raspberry Pi.</p>
</blockquote>
<p>Usage:</p>
<pre><code class="ts"><span class="hl-2">// In a .ts file</span><br/><span class="hl-3">import</span><span class="hl-1"> </span><span class="hl-4">*</span><span class="hl-1"> </span><span class="hl-3">as</span><span class="hl-1"> </span><span class="hl-0">matrix</span><span class="hl-1"> </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-5">&#39;rpi-led-matrix&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-2">// Or, in a .js file</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-6">matrix</span><span class="hl-1"> = </span><span class="hl-7">require</span><span class="hl-1">(</span><span class="hl-5">&#39;rpi-led-matrix&#39;</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<a id="getting-started" class="tsd-anchor"></a><h1 class="tsd-anchor-link">Getting Started<a href="#getting-started" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h1><p>The majority of the work in getting your LED matrix up and shining will inevitably be getting it configured first. This package provides a couple of helpers that should make configuration painless.</p>
<a id="the-bare-minimum" class="tsd-anchor"></a><h2 class="tsd-anchor-link">The bare minimum<a href="#the-bare-minimum" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Creating a matrix means creating an instance of the class <code>LedMatrix</code>, whose constructor has the following signature (with a few static methods described below):</p>
<pre><code class="ts"><span class="hl-4">interface</span><span class="hl-1"> </span><span class="hl-8">LedMatrix</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">new</span><span class="hl-1"> (</span><span class="hl-0">mOpts</span><span class="hl-1">: </span><span class="hl-8">MatrixOptions</span><span class="hl-1">, </span><span class="hl-0">rOpts</span><span class="hl-1">: </span><span class="hl-8">RuntimeOptions</span><span class="hl-1">): </span><span class="hl-8">LedMatrixInstance</span><span class="hl-1">;</span><br/><br/><span class="hl-1">  </span><span class="hl-7">defaultMatrixOptions</span><span class="hl-1">(): </span><span class="hl-8">MatrixOptions</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-7">defaultRuntimeOptions</span><span class="hl-1">(): </span><span class="hl-8">RuntimeOptions</span><span class="hl-1">;</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<blockquote>
<p><strong>Note</strong>: <code>LedMatrix</code> is represented as an <code>interface</code> rather than a <code>class</code> because the actual <code>LedMatrix</code> module is a native C++ addon.</p>
</blockquote>
<p>Both <code>MatrixOptions</code> and <code>RuntimeOptions</code> are of a non-trivial size in terms of available options. Fortunately, <code>LedMatrix</code> has those two static methods that return either config types with all properties set to their default values.</p>
<p>With the use of those helper methods, this is all it takes to create a matrix (of types <code>LedMatrixInstance</code>) that's ready to glow:</p>
<pre><code class="ts"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-0">LedMatrix</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-5">&#39;rpi-led-matrix&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-6">matrix</span><span class="hl-1"> = </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-7">LedMatrix</span><span class="hl-1">(</span><br/><span class="hl-1">  </span><span class="hl-0">LedMatrix</span><span class="hl-1">.</span><span class="hl-7">defaultMatrixOptions</span><span class="hl-1">(),</span><br/><span class="hl-1">  </span><span class="hl-0">LedMatrix</span><span class="hl-1">.</span><span class="hl-7">defaultRuntimeOptions</span><span class="hl-1">()</span><br/><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<a id="configuration" class="tsd-anchor"></a><h1 class="tsd-anchor-link">Configuration<a href="#configuration" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h1><p><img src="media/text-layout-center-middle.jpg" alt="extending defaults"><em>There's an extensive CLI you can use for testing text rendering/alignment/manipulation in <code>examples/text-layout-cli.ts</code></em></p>
<p>The <code>LedMatrix</code> constructor expects <em>all</em> configuration properties to be defined. So, identify the options you want to change, and extend the default options.</p>
<p>The image above are the panels I've been using to test, and below is how I've configured it in my code. Keep in mind that every setup is different, so you'll need to find the config that works for you.</p>
<pre><code class="ts"><span class="hl-3">import</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-0">LedMatrix</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">GpioMapping</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">LedMatrixUtils</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">PixelMapperType</span><span class="hl-1">,</span><br/><span class="hl-1">} </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-5">&#39;rpi-led-matrix&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-6">matrix</span><span class="hl-1"> = </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-7">LedMatrix</span><span class="hl-1">(</span><br/><span class="hl-1">  {</span><br/><span class="hl-1">    ...</span><span class="hl-0">LedMatrix</span><span class="hl-1">.</span><span class="hl-7">defaultMatrixOptions</span><span class="hl-1">(),</span><br/><span class="hl-1">    </span><span class="hl-0">rows:</span><span class="hl-1"> </span><span class="hl-9">32</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-0">cols:</span><span class="hl-1"> </span><span class="hl-9">64</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-0">chainLength:</span><span class="hl-1"> </span><span class="hl-9">2</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-0">hardwareMapping:</span><span class="hl-1"> </span><span class="hl-0">GpioMapping</span><span class="hl-1">.</span><span class="hl-0">AdafruitHatPwm</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-0">pixelMapperConfig:</span><span class="hl-1"> </span><span class="hl-0">LedMatrixUtils</span><span class="hl-1">.</span><span class="hl-7">encodeMappers</span><span class="hl-1">({</span><br/><span class="hl-1">      </span><span class="hl-0">type:</span><span class="hl-1"> </span><span class="hl-0">PixelMapperType</span><span class="hl-1">.</span><span class="hl-6">U</span><span class="hl-1">,</span><br/><span class="hl-1">    }),</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  {</span><br/><span class="hl-1">    ...</span><span class="hl-0">LedMatrix</span><span class="hl-1">.</span><span class="hl-7">defaultRuntimeOptions</span><span class="hl-1">(),</span><br/><span class="hl-1">    </span><span class="hl-0">gpioSlowdown:</span><span class="hl-1"> </span><span class="hl-9">1</span><span class="hl-1">,</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<p>For most options with a fixed, discrete set of valid values, like <code>hardwareMapping</code>, there is a corresponding <code>enum</code> you can use to see the possible values.</p>
<p><code>pixelMapperConfig</code>, which specifies special mappings that describe the physical configuration of your LED matrices, requires a more complex value with the desired mapping encoded as a string. For that, you can use <code>LedMatrixUtils</code>, which provides the static method <code>encodeMappers</code> that generates the encoded string for you.</p>
<a id="options-on-options" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Options on options<a href="#options-on-options" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="matrix-options" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Matrix options<a href="#matrix-options" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The full <code>MatrixOptions</code> interface and the enums it uses are outlined below.</p>
<blockquote>
<p><strong>Note</strong>: I've added comments for the meaning of each option in the source files. In general, I'd suggest referencing the <a href="https://github.com/hzeller/rpi-rgb-led-matrix">original library on which these options are based</a>, which might provide more detailed descriptions.</p>
</blockquote>
<pre><code class="ts"><span class="hl-4">interface</span><span class="hl-1"> </span><span class="hl-8">MatrixOptions</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-0">brightness</span><span class="hl-1">: </span><span class="hl-8">number</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-0">chainLength</span><span class="hl-1">: </span><span class="hl-9">1</span><span class="hl-1"> | </span><span class="hl-9">2</span><span class="hl-1"> | </span><span class="hl-9">3</span><span class="hl-1"> | </span><span class="hl-9">4</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-0">cols</span><span class="hl-1">: </span><span class="hl-9">16</span><span class="hl-1"> | </span><span class="hl-9">32</span><span class="hl-1"> | </span><span class="hl-9">40</span><span class="hl-1"> | </span><span class="hl-9">64</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-0">disableHardwarePulsing</span><span class="hl-1">: </span><span class="hl-8">boolean</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-0">hardwareMapping</span><span class="hl-1">: </span><span class="hl-8">GpioMapping</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-0">inverseColors</span><span class="hl-1">: </span><span class="hl-8">boolean</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-0">ledRgbSequence</span><span class="hl-1">: </span><span class="hl-5">&#39;RGB&#39;</span><span class="hl-1"> | </span><span class="hl-5">&#39;BGR&#39;</span><span class="hl-1"> | </span><span class="hl-5">&#39;BRG&#39;</span><span class="hl-1"> | </span><span class="hl-5">&#39;RBG&#39;</span><span class="hl-1"> | </span><span class="hl-5">&#39;GRB&#39;</span><span class="hl-1"> | </span><span class="hl-5">&#39;GBR&#39;</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-0">limitRefreshRateHz</span><span class="hl-1">: </span><span class="hl-8">number</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-0">multiplexing</span><span class="hl-1">: </span><span class="hl-8">MuxType</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-0">panelType</span><span class="hl-1">: </span><span class="hl-5">&#39;&#39;</span><span class="hl-1"> | </span><span class="hl-5">&#39;FM6126A&#39;</span><span class="hl-1"> | </span><span class="hl-5">&#39;FM6127&#39;</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-0">parallel</span><span class="hl-1">: </span><span class="hl-9">1</span><span class="hl-1"> | </span><span class="hl-9">2</span><span class="hl-1"> | </span><span class="hl-9">3</span><span class="hl-1"> | </span><span class="hl-9">4</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-0">pixelMapperConfig</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-0">pwmBits</span><span class="hl-1">: </span><span class="hl-9">1</span><span class="hl-1"> | </span><span class="hl-9">2</span><span class="hl-1"> | </span><span class="hl-9">3</span><span class="hl-1"> | </span><span class="hl-9">4</span><span class="hl-1"> | </span><span class="hl-9">5</span><span class="hl-1"> | </span><span class="hl-9">6</span><span class="hl-1"> | </span><span class="hl-9">7</span><span class="hl-1"> | </span><span class="hl-9">8</span><span class="hl-1"> | </span><span class="hl-9">9</span><span class="hl-1"> | </span><span class="hl-9">10</span><span class="hl-1"> | </span><span class="hl-9">11</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-0">pwmDitherBits</span><span class="hl-1">: </span><span class="hl-8">number</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-0">pwmLsbNanoseconds</span><span class="hl-1">: </span><span class="hl-8">number</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-0">rowAddressType</span><span class="hl-1">: </span><span class="hl-8">RowAddressType</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-0">rows</span><span class="hl-1">: </span><span class="hl-9">16</span><span class="hl-1"> | </span><span class="hl-9">32</span><span class="hl-1"> | </span><span class="hl-9">64</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-0">scanMode</span><span class="hl-1">: </span><span class="hl-8">ScanMode</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-0">showRefreshRate</span><span class="hl-1">: </span><span class="hl-8">boolean</span><span class="hl-1">;</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<pre><code class="ts"><span class="hl-4">enum</span><span class="hl-1"> </span><span class="hl-8">ScanMode</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-6">Progressive</span><span class="hl-1"> = </span><span class="hl-9">0</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-6">Interlaced</span><span class="hl-1"> = </span><span class="hl-9">1</span><span class="hl-1">,</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<pre><code class="ts"><span class="hl-4">enum</span><span class="hl-1"> </span><span class="hl-8">MuxType</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-6">Direct</span><span class="hl-1"> = </span><span class="hl-9">0</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-6">Stripe</span><span class="hl-1"> = </span><span class="hl-9">1</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-6">Checker</span><span class="hl-1"> = </span><span class="hl-9">2</span><span class="hl-1">,</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<pre><code class="ts"><span class="hl-4">enum</span><span class="hl-1"> </span><span class="hl-8">RowAddressType</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-6">Direct</span><span class="hl-1"> = </span><span class="hl-9">0</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-6">AB</span><span class="hl-1"> = </span><span class="hl-9">1</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-6">DirectRow</span><span class="hl-1"> = </span><span class="hl-9">2</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-6">ABC</span><span class="hl-1"> = </span><span class="hl-9">3</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-6">ABCShift</span><span class="hl-1"> = </span><span class="hl-9">4</span><span class="hl-1">,</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<pre><code class="ts"><span class="hl-4">enum</span><span class="hl-1"> </span><span class="hl-8">GpioMapping</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-6">Regular</span><span class="hl-1"> = </span><span class="hl-5">&#39;regular&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-6">AdafruitHat</span><span class="hl-1"> = </span><span class="hl-5">&#39;adafruit-hat&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-6">AdafruitHatPwm</span><span class="hl-1"> = </span><span class="hl-5">&#39;adafruit-hat-pwm&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-6">RegularPi1</span><span class="hl-1"> = </span><span class="hl-5">&#39;regular-pi1&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-6">Classic</span><span class="hl-1"> = </span><span class="hl-5">&#39;classic&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-6">ClassicPi1</span><span class="hl-1"> = </span><span class="hl-5">&#39;classic-pi1&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<a id="runtime-options" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Runtime options<a href="#runtime-options" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The <code>RuntimeOptions</code> interface and its associated enum look like this:</p>
<pre><code class="ts"><span class="hl-4">interface</span><span class="hl-1"> </span><span class="hl-8">RuntimeOptions</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-0">daemon</span><span class="hl-1">: </span><span class="hl-8">RuntimeFlag</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-0">doGpioInit</span><span class="hl-1">: </span><span class="hl-8">boolean</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-0">dropPrivileges</span><span class="hl-1">: </span><span class="hl-8">RuntimeFlag</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-0">gpioSlowdown</span><span class="hl-1">: </span><span class="hl-9">0</span><span class="hl-1"> | </span><span class="hl-9">1</span><span class="hl-1"> | </span><span class="hl-9">2</span><span class="hl-1"> | </span><span class="hl-9">3</span><span class="hl-1"> | </span><span class="hl-9">4</span><span class="hl-1">;</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<pre><code class="ts"><span class="hl-4">enum</span><span class="hl-1"> </span><span class="hl-8">RuntimeFlag</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-6">Disabled</span><span class="hl-1"> = -</span><span class="hl-9">1</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-6">Off</span><span class="hl-1"> = </span><span class="hl-9">0</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-6">On</span><span class="hl-1"> = </span><span class="hl-9">1</span><span class="hl-1">,</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<a id="drawing" class="tsd-anchor"></a><h1 class="tsd-anchor-link">Drawing<a href="#drawing" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h1><p>After getting your configuration figured out, you've now got an <code>LedMatrixInstance</code> to play with.</p>
<p>The interface for a matrix instance looks like this:</p>
<pre><code class="ts"><span class="hl-4">interface</span><span class="hl-1"> </span><span class="hl-8">LedMatrixInstance</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-7">bgColor</span><span class="hl-1">(</span><span class="hl-0">color</span><span class="hl-1">: </span><span class="hl-8">Color</span><span class="hl-1"> | </span><span class="hl-8">number</span><span class="hl-1">): </span><span class="hl-8">this</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-7">bgColor</span><span class="hl-1">(): </span><span class="hl-8">Color</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-7">brightness</span><span class="hl-1">(</span><span class="hl-0">brightness</span><span class="hl-1">: </span><span class="hl-8">number</span><span class="hl-1">): </span><span class="hl-8">this</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-7">brightness</span><span class="hl-1">(): </span><span class="hl-8">number</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-7">clear</span><span class="hl-1">(): </span><span class="hl-8">this</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-7">clear</span><span class="hl-1">(</span><span class="hl-0">x0</span><span class="hl-1">: </span><span class="hl-8">number</span><span class="hl-1">, </span><span class="hl-0">y0</span><span class="hl-1">: </span><span class="hl-8">number</span><span class="hl-1">, </span><span class="hl-0">x1</span><span class="hl-1">: </span><span class="hl-8">number</span><span class="hl-1">, </span><span class="hl-0">y1</span><span class="hl-1">: </span><span class="hl-8">number</span><span class="hl-1">): </span><span class="hl-8">this</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-7">drawBuffer</span><span class="hl-1">(</span><span class="hl-0">buffer</span><span class="hl-1">: </span><span class="hl-8">Buffer</span><span class="hl-1"> | </span><span class="hl-8">Uint8Array</span><span class="hl-1">, </span><span class="hl-0">w</span><span class="hl-1">?: </span><span class="hl-8">number</span><span class="hl-1">, </span><span class="hl-0">h</span><span class="hl-1">?: </span><span class="hl-8">number</span><span class="hl-1">): </span><span class="hl-8">this</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-7">drawCircle</span><span class="hl-1">(</span><span class="hl-0">x</span><span class="hl-1">: </span><span class="hl-8">number</span><span class="hl-1">, </span><span class="hl-0">y</span><span class="hl-1">: </span><span class="hl-8">number</span><span class="hl-1">, </span><span class="hl-0">r</span><span class="hl-1">: </span><span class="hl-8">number</span><span class="hl-1">): </span><span class="hl-8">this</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-7">drawLine</span><span class="hl-1">(</span><span class="hl-0">x0</span><span class="hl-1">: </span><span class="hl-8">number</span><span class="hl-1">, </span><span class="hl-0">y0</span><span class="hl-1">: </span><span class="hl-8">number</span><span class="hl-1">, </span><span class="hl-0">x1</span><span class="hl-1">: </span><span class="hl-8">number</span><span class="hl-1">, </span><span class="hl-0">y1</span><span class="hl-1">: </span><span class="hl-8">number</span><span class="hl-1">): </span><span class="hl-8">this</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-7">drawRect</span><span class="hl-1">(</span><span class="hl-0">x0</span><span class="hl-1">: </span><span class="hl-8">number</span><span class="hl-1">, </span><span class="hl-0">y0</span><span class="hl-1">: </span><span class="hl-8">number</span><span class="hl-1">, </span><span class="hl-0">width</span><span class="hl-1">: </span><span class="hl-8">number</span><span class="hl-1">, </span><span class="hl-0">height</span><span class="hl-1">: </span><span class="hl-8">number</span><span class="hl-1">): </span><span class="hl-8">this</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-7">drawText</span><span class="hl-1">(</span><span class="hl-0">text</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">, </span><span class="hl-0">x</span><span class="hl-1">: </span><span class="hl-8">number</span><span class="hl-1">, </span><span class="hl-0">y</span><span class="hl-1">: </span><span class="hl-8">number</span><span class="hl-1">, </span><span class="hl-0">kerning</span><span class="hl-1">?: </span><span class="hl-8">number</span><span class="hl-1">): </span><span class="hl-8">this</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-7">fgColor</span><span class="hl-1">(</span><span class="hl-0">color</span><span class="hl-1">: </span><span class="hl-8">Color</span><span class="hl-1"> | </span><span class="hl-8">number</span><span class="hl-1">): </span><span class="hl-8">this</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-7">fgColor</span><span class="hl-1">(): </span><span class="hl-8">Color</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-7">fill</span><span class="hl-1">(): </span><span class="hl-8">this</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-7">fill</span><span class="hl-1">(</span><span class="hl-0">x0</span><span class="hl-1">: </span><span class="hl-8">number</span><span class="hl-1">, </span><span class="hl-0">y0</span><span class="hl-1">: </span><span class="hl-8">number</span><span class="hl-1">, </span><span class="hl-0">x1</span><span class="hl-1">: </span><span class="hl-8">number</span><span class="hl-1">, </span><span class="hl-0">y1</span><span class="hl-1">: </span><span class="hl-8">number</span><span class="hl-1">): </span><span class="hl-8">this</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-7">font</span><span class="hl-1">(</span><span class="hl-0">font</span><span class="hl-1">: </span><span class="hl-8">FontInstance</span><span class="hl-1">): </span><span class="hl-8">this</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-7">font</span><span class="hl-1">(): </span><span class="hl-8">string</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-7">height</span><span class="hl-1">(): </span><span class="hl-8">number</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-7">luminanceCorrect</span><span class="hl-1">(</span><span class="hl-0">correct</span><span class="hl-1">: </span><span class="hl-8">boolean</span><span class="hl-1">): </span><span class="hl-8">this</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-7">luminanceCorrect</span><span class="hl-1">(): </span><span class="hl-8">boolean</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-7">pwmBits</span><span class="hl-1">(</span><span class="hl-0">pwmBits</span><span class="hl-1">: </span><span class="hl-8">number</span><span class="hl-1">): </span><span class="hl-8">this</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-7">pwmBits</span><span class="hl-1">(): </span><span class="hl-8">number</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-7">setPixel</span><span class="hl-1">(</span><span class="hl-0">x</span><span class="hl-1">: </span><span class="hl-8">number</span><span class="hl-1">, </span><span class="hl-0">y</span><span class="hl-1">: </span><span class="hl-8">number</span><span class="hl-1">): </span><span class="hl-8">this</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-7">sync</span><span class="hl-1">(): </span><span class="hl-8">void</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-7">width</span><span class="hl-1">(): </span><span class="hl-8">number</span><span class="hl-1">;</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<a id="usage-patterns" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Usage Patterns<a href="#usage-patterns" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>There are a few patterns you might notice about the matrix instance type.</p>
<p>The majority of methods come in two forms: a getter and a setter. If you call a method without any arguments, you'll get the current value back. If you call a method <em>with</em> argument, the method acts as a setter, and the same matrix instance is returned. This means that <strong>nearly all matrix operations are chainable.</strong></p>
<p>So we can have something like this:</p>
<pre><code class="ts"><span class="hl-0">matrix</span><br/><span class="hl-1">  .</span><span class="hl-7">clear</span><span class="hl-1">() </span><span class="hl-2">// clear the display</span><br/><span class="hl-1">  .</span><span class="hl-7">brightness</span><span class="hl-1">(</span><span class="hl-9">100</span><span class="hl-1">) </span><span class="hl-2">// set the panel brightness to 100%</span><br/><span class="hl-1">  .</span><span class="hl-7">fgColor</span><span class="hl-1">(</span><span class="hl-9">0x0000ff</span><span class="hl-1">) </span><span class="hl-2">// set the active color to blue</span><br/><span class="hl-1">  .</span><span class="hl-7">fill</span><span class="hl-1">() </span><span class="hl-2">// color the entire diplay blue</span><br/><span class="hl-1">  .</span><span class="hl-7">fgColor</span><span class="hl-1">(</span><span class="hl-9">0xffff00</span><span class="hl-1">) </span><span class="hl-2">// set the active color to yellow</span><br/><span class="hl-1">  </span><span class="hl-2">// draw a yellow circle around the display</span><br/><span class="hl-1">  .</span><span class="hl-7">drawCircle</span><span class="hl-1">(</span><span class="hl-0">matrix</span><span class="hl-1">.</span><span class="hl-7">width</span><span class="hl-1">() / </span><span class="hl-9">2</span><span class="hl-1">, </span><span class="hl-0">matrix</span><span class="hl-1">.</span><span class="hl-7">height</span><span class="hl-1">() / </span><span class="hl-9">2</span><span class="hl-1">, </span><span class="hl-0">matrix</span><span class="hl-1">.</span><span class="hl-7">width</span><span class="hl-1">() / </span><span class="hl-9">2</span><span class="hl-1"> - </span><span class="hl-9">1</span><span class="hl-1">)</span><br/><span class="hl-1">  </span><span class="hl-2">// draw a yellow rectangle</span><br/><span class="hl-1">  .</span><span class="hl-7">drawRect</span><span class="hl-1">(</span><br/><span class="hl-1">    </span><span class="hl-0">matrix</span><span class="hl-1">.</span><span class="hl-7">width</span><span class="hl-1">() / </span><span class="hl-9">4</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-0">matrix</span><span class="hl-1">.</span><span class="hl-7">height</span><span class="hl-1">() / </span><span class="hl-9">4</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-0">matrix</span><span class="hl-1">.</span><span class="hl-7">width</span><span class="hl-1">() / </span><span class="hl-9">2</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-0">matrix</span><span class="hl-1">.</span><span class="hl-7">height</span><span class="hl-1">() / </span><span class="hl-9">2</span><br/><span class="hl-1">  )</span><br/><span class="hl-1">  </span><span class="hl-2">// sets the active color to red</span><br/><span class="hl-1">  .</span><span class="hl-7">fgColor</span><span class="hl-1">({ </span><span class="hl-0">r:</span><span class="hl-1"> </span><span class="hl-9">255</span><span class="hl-1">, </span><span class="hl-0">g:</span><span class="hl-1"> </span><span class="hl-9">0</span><span class="hl-1">, </span><span class="hl-0">b:</span><span class="hl-1"> </span><span class="hl-9">0</span><span class="hl-1"> })</span><br/><span class="hl-1">  </span><span class="hl-2">// draw two diagonal red lines connecting the corners</span><br/><span class="hl-1">  .</span><span class="hl-7">drawLine</span><span class="hl-1">(</span><span class="hl-9">0</span><span class="hl-1">, </span><span class="hl-9">0</span><span class="hl-1">, </span><span class="hl-0">matrix</span><span class="hl-1">.</span><span class="hl-7">width</span><span class="hl-1">(), </span><span class="hl-0">matrix</span><span class="hl-1">.</span><span class="hl-7">height</span><span class="hl-1">())</span><br/><span class="hl-1">  .</span><span class="hl-7">drawLine</span><span class="hl-1">(</span><span class="hl-0">matrix</span><span class="hl-1">.</span><span class="hl-7">width</span><span class="hl-1">() - </span><span class="hl-9">1</span><span class="hl-1">, </span><span class="hl-9">0</span><span class="hl-1">, </span><span class="hl-9">0</span><span class="hl-1">, </span><span class="hl-0">matrix</span><span class="hl-1">.</span><span class="hl-7">height</span><span class="hl-1">() - </span><span class="hl-9">1</span><span class="hl-1">)</span><br/><span class="hl-1">  .</span><span class="hl-7">sync</span><span class="hl-1">();</span>
</code><button type="button">Copy</button></pre>

<p>And we'll get this:</p>
<p><img src="/media/simple-shapes.jpg" alt="simple-shapes"></p>
<a id="sync-hook" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Sync Hook<a href="#sync-hook" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>For more time-dependent animations, an <code>LedMatrixInstance</code> has an <code>afterSync</code> method that you can supply with a callback function that will be called automatically after each matrix sync. The callback you provide has the following type:</p>
<pre><code class="ts"><span class="hl-4">type</span><span class="hl-1"> </span><span class="hl-8">SyncHook</span><span class="hl-1"> = (</span><span class="hl-0">matrix</span><span class="hl-1">: </span><span class="hl-8">LedMatrixInstance</span><span class="hl-1">, </span><span class="hl-0">dt</span><span class="hl-1">: </span><span class="hl-8">number</span><span class="hl-1">, </span><span class="hl-0">t</span><span class="hl-1">: </span><span class="hl-8">number</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> </span><span class="hl-8">void</span><span class="hl-1">;</span>
</code><button type="button">Copy</button></pre>

<p>Where <code>matrix</code> is the matrix instance, <code>dt</code> is the amount of time (in milliseconds) since the previous sync, and <code>t</code> is the monotonically-increasing time (in milliseconds) of the system clock.</p>
<p>If we wanted to write a program such that all of the matrix's LEDs pulsed individually with their own random frequency, I could write a wrapper class like this:</p>
<pre><code class="ts"><span class="hl-4">class</span><span class="hl-1"> </span><span class="hl-8">Pulser</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">constructor</span><span class="hl-1">(</span><br/><span class="hl-1">    </span><span class="hl-4">readonly</span><span class="hl-1"> </span><span class="hl-0">x</span><span class="hl-1">: </span><span class="hl-8">number</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">readonly</span><span class="hl-1"> </span><span class="hl-0">y</span><span class="hl-1">: </span><span class="hl-8">number</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">readonly</span><span class="hl-1"> </span><span class="hl-0">f</span><span class="hl-1">: </span><span class="hl-8">number</span><br/><span class="hl-1">  ) {}</span><br/><br/><span class="hl-1">  </span><span class="hl-7">nextColor</span><span class="hl-1">(</span><span class="hl-0">t</span><span class="hl-1">: </span><span class="hl-8">number</span><span class="hl-1">): </span><span class="hl-8">number</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-2">/** You could easily work position-dependent logic into this expression */</span><br/><span class="hl-1">    </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-6">brightness</span><span class="hl-1"> = </span><span class="hl-9">0xff</span><span class="hl-1"> &amp; </span><span class="hl-0">Math</span><span class="hl-1">.</span><span class="hl-7">max</span><span class="hl-1">(</span><span class="hl-9">0</span><span class="hl-1">, </span><span class="hl-9">255</span><span class="hl-1"> * </span><span class="hl-0">Math</span><span class="hl-1">.</span><span class="hl-7">sin</span><span class="hl-1">((</span><span class="hl-4">this</span><span class="hl-1">.</span><span class="hl-0">f</span><span class="hl-1"> * </span><span class="hl-0">t</span><span class="hl-1">) / </span><span class="hl-9">1000</span><span class="hl-1">));</span><br/><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> (</span><span class="hl-0">brightness</span><span class="hl-1"> &lt;&lt; </span><span class="hl-9">16</span><span class="hl-1">) | (</span><span class="hl-0">brightness</span><span class="hl-1"> &lt;&lt; </span><span class="hl-9">8</span><span class="hl-1">) | </span><span class="hl-0">brightness</span><span class="hl-1">;</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p>Initialize the matrix and create an instance of <code>Pulser</code> for each pixel:</p>
<pre><code class="ts"><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-6">matrix</span><span class="hl-1"> = </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-7">LedMatrix</span><span class="hl-1">(</span><span class="hl-0">matrixOptions</span><span class="hl-1">, </span><span class="hl-0">runtimeOptions</span><span class="hl-1">);</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-6">pulsers</span><span class="hl-1">: </span><span class="hl-8">Pulser</span><span class="hl-1">[] = [];</span><br/><br/><span class="hl-3">for</span><span class="hl-1"> (</span><span class="hl-4">let</span><span class="hl-1"> </span><span class="hl-0">x</span><span class="hl-1"> = </span><span class="hl-9">0</span><span class="hl-1">; </span><span class="hl-0">x</span><span class="hl-1"> &lt; </span><span class="hl-0">matrix</span><span class="hl-1">.</span><span class="hl-7">width</span><span class="hl-1">(); </span><span class="hl-0">x</span><span class="hl-1">++) {</span><br/><span class="hl-1">  </span><span class="hl-3">for</span><span class="hl-1"> (</span><span class="hl-4">let</span><span class="hl-1"> </span><span class="hl-0">y</span><span class="hl-1"> = </span><span class="hl-9">0</span><span class="hl-1">; </span><span class="hl-0">y</span><span class="hl-1"> &lt; </span><span class="hl-0">matrix</span><span class="hl-1">.</span><span class="hl-7">height</span><span class="hl-1">(); </span><span class="hl-0">y</span><span class="hl-1">++) {</span><br/><span class="hl-1">    </span><span class="hl-0">pulsers</span><span class="hl-1">.</span><span class="hl-7">push</span><span class="hl-1">(</span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-7">Pulser</span><span class="hl-1">(</span><span class="hl-0">x</span><span class="hl-1">, </span><span class="hl-0">y</span><span class="hl-1">, </span><span class="hl-9">5</span><span class="hl-1"> * </span><span class="hl-0">Math</span><span class="hl-1">.</span><span class="hl-7">random</span><span class="hl-1">()));</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p>Finally, apply a sync hook that updates each pixel after each sync:</p>
<pre><code class="ts"><span class="hl-0">matrix</span><span class="hl-1">.</span><span class="hl-7">afterSync</span><span class="hl-1">((</span><span class="hl-0">mat</span><span class="hl-1">, </span><span class="hl-0">dt</span><span class="hl-1">, </span><span class="hl-0">t</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-0">pulsers</span><span class="hl-1">.</span><span class="hl-7">forEach</span><span class="hl-1">(</span><span class="hl-0">pulser</span><span class="hl-1"> </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">matrix</span><span class="hl-1">.</span><span class="hl-7">fgColor</span><span class="hl-1">(</span><span class="hl-0">pulser</span><span class="hl-1">.</span><span class="hl-7">nextColor</span><span class="hl-1">(</span><span class="hl-0">t</span><span class="hl-1">)).</span><span class="hl-7">setPixel</span><span class="hl-1">(</span><span class="hl-0">pulser</span><span class="hl-1">.</span><span class="hl-0">x</span><span class="hl-1">, </span><span class="hl-0">pulser</span><span class="hl-1">.</span><span class="hl-0">y</span><span class="hl-1">);</span><br/><span class="hl-1">  });</span><br/><br/><span class="hl-1">  </span><span class="hl-7">setTimeout</span><span class="hl-1">(() </span><span class="hl-4">=&gt;</span><span class="hl-1"> </span><span class="hl-0">matrix</span><span class="hl-1">.</span><span class="hl-7">sync</span><span class="hl-1">(), </span><span class="hl-9">0</span><span class="hl-1">);</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-2">// Get it started</span><br/><span class="hl-0">matrix</span><span class="hl-1">.</span><span class="hl-7">sync</span><span class="hl-1">();</span>
</code><button type="button">Copy</button></pre>

<p>This pattern is somewhat reflective of <code>requestAnimationFrame</code> recursion on the frontend. <strong>NOTE:</strong> Make sure to wrap the call to <code>.sync()</code> inside the sync hook callback function in a <code>setTimeout</code> so that the call is defered to the next turn of the event loop. Otherwise, you'll quickly get a stack overflow error.</p>
<p>After that, we're left with this (click for video):</p>
<p><a href="https://apemedia.s3.us-east-2.amazonaws.com/twinkle720.mp4"><img src="media/sync-hook-thumbnail.png" alt="full demo"><em>You can run this yourself using <code>examples/sync-hooks.ts</code></em></a></p>
<a id="running-examples" class="tsd-anchor"></a><h1 class="tsd-anchor-link">Running Examples<a href="#running-examples" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h1><p>Clone/fork this repo onto both your local machine and your Raspberry Pi.</p>
<pre><code class="bash"><span class="hl-7">git</span><span class="hl-1"> </span><span class="hl-5">clone</span><span class="hl-1"> </span><span class="hl-4">--recurse-submodules</span><span class="hl-1"> </span><span class="hl-5">https://github.com/alexeden/rpi-led-matrix</span><br/><span class="hl-7">cd</span><span class="hl-1"> </span><span class="hl-5">rpi-led-matrix</span><br/><span class="hl-7">npm</span><span class="hl-1"> </span><span class="hl-5">i</span>
</code><button type="button">Copy</button></pre>

<p>Update the file <code>examples/_config.ts</code> with your own matrix configuration. All of the examples will import the configuration objects exported by the file.</p>
<p>Examples can be run using <code>tsx</code>. e.g. to run the <code>kitchen-sink</code> example:</p>
<pre><code class="bash"><span class="hl-7">sudo</span><span class="hl-1"> </span><span class="hl-5">npx</span><span class="hl-1"> </span><span class="hl-5">tsx</span><span class="hl-1"> </span><span class="hl-5">examples/kitchen-sink.ts</span>
</code><button type="button">Copy</button></pre>

<a id="api" class="tsd-anchor"></a><h1 class="tsd-anchor-link">API<a href="#api" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h1><p>The package exports the following enums, types, and classes:</p>
<a id="configuration-option-enums" class="tsd-anchor"></a><h4 class="tsd-anchor-link">Configuration option enums<a href="#configuration-option-enums" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><ul>
<li><code>GpioMapping</code></li>
<li><code>MuxType</code></li>
<li><code>PixelMapper</code></li>
<li><code>PixelMapperType</code></li>
<li><code>RowAddressType</code></li>
<li><code>RuntimeFlag</code></li>
<li><code>ScanMode</code></li>
</ul>
<hr>
<a id="configuration-interfaces" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Configuration interfaces<a href="#configuration-interfaces" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The underlying <a href="https://github.com/hzeller/rpi-rgb-led-matrix#changing-parameters-via-command-line-flags">rpi-rgb-led-matrix</a> draws a distinction between two types of configurations: matrix and runtime. This package exposes two interfaces that reflect them:</p>
<ul>
<li><code>MatrixOptions</code></li>
<li><code>RuntimeOptions</code></li>
</ul>
<hr>
<a id="ledmatrixutils-1" class="tsd-anchor"></a><h4 class="tsd-anchor-link"><code>LedMatrixUtils</code><a href="#ledmatrixutils-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><p>Provides helper methods for configuring a matrix.</p>
<hr>
<a id="font-and-ledmatrix" class="tsd-anchor"></a><h4 class="tsd-anchor-link"><code>Font</code> and <code>LedMatrix</code><a href="#font-and-ledmatrix" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><p>The instantiable classes that wrap the native <code>Font</code> and <code>LedMatrix</code> entities.</p>
<p>There are also the associated TypeScript interfaces that describe the static and instance methods of <code>Font</code> and <code>LedMatrix</code>:</p>
<ul>
<li><code>Font</code></li>
<li><code>FontInstance</code></li>
<li><code>LedMatrix</code></li>
<li><code>LedMatrixInstance</code></li>
</ul>
<hr>
<a id="layoututils-1" class="tsd-anchor"></a><h4 class="tsd-anchor-link"><code>LayoutUtils</code><a href="#layoututils-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><p>A gratuitious set of functionality for making text rendering super easy.</p>
<p>There is also a set of enums and types associated with the utility methods:</p>
<ul>
<li><code>MappedGlyph</code></li>
<li><code>Line</code></li>
<li><code>HorizontalAlignment</code></li>
<li><code>VerticalAlignment</code></li>
</ul>
<hr>
<a id="developing-locally" class="tsd-anchor"></a><h1 class="tsd-anchor-link">Developing Locally<a href="#developing-locally" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h1><blockquote>
<p>Make sure you have <a href="https://www.raspberrypi.org/documentation/remote-access/ssh/passwordless.md">passwordless SSH</a> access to your Raspberry Pi.</p>
</blockquote>
<p>Clone/fork this repo onto both your local machine and your Raspberry Pi.</p>
<pre><code class="bash"><span class="hl-7">$</span><span class="hl-1"> </span><span class="hl-5">git</span><span class="hl-1"> </span><span class="hl-5">clone</span><span class="hl-1"> </span><span class="hl-4">--recurse-submodules</span><span class="hl-1"> </span><span class="hl-5">https://github.com/alexeden/rpi-led-matrix</span>
</code><button type="button">Copy</button></pre>

<p><code>npm install</code> inside both repos.</p>
<p>Create a file called <code>sync.config.json</code> on the machine on which you'll be developing, and substitute these values with your own:</p>
<pre><code class="jsonc"><span class="hl-1">{</span><br/><span class="hl-1">  </span><span class="hl-10">&quot;username&quot;</span><span class="hl-1">: </span><span class="hl-5">&quot;&lt;username&gt;&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-10">&quot;hostname&quot;</span><span class="hl-1">: </span><span class="hl-5">&quot;&lt;hostname or IP address of your Pi&gt;&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-10">&quot;directory&quot;</span><span class="hl-1">: </span><span class="hl-5">&quot;&lt;parent directory on Pi into which the repo was cloned&gt;&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-10">&quot;quiet&quot;</span><span class="hl-1">: </span><span class="hl-4">false</span><span class="hl-1">, </span><span class="hl-2">// Disable most rsync logs (defaults to false)</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p><strong>Locally</strong>, you can now run <code>npm run sync-changes</code>, and any changes made to files inside <code>/src</code> or <code>/examples</code> will automatically be uploaded to your Pi.</p>
<p><strong>From the Pi</strong>, you can run <code>npm run build-changes</code>, and any changes pushed from your local machine will automatically be rebuilt. You can run additional scripts (test scripts, etc) by appending the shell commands to the <code>exec</code> property inside <code>nodemon.build.json</code>.</p>
<blockquote>
<p>Per <a href="https://github.com/alexeden/rpi-led-matrix/issues/2">this issue</a>, if you get the error &quot;TypeError: cannot use a string pattern on a bytes-like object&quot; when running <code>npm install</code>, try switching your environment to python 2.7.</p>
</blockquote>
</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#raspberry-pi-led-matrix"><span>Raspberry <wbr/>Pi LED <wbr/>Matrix</span></a><ul><li><a href="#features"><span>Features</span></a></li><li><a href="#installation-and-usage"><span>Installation and <wbr/>Usage</span></a></li></ul><a href="#getting-started"><span>Getting <wbr/>Started</span></a><ul><li><a href="#the-bare-minimum"><span>The bare minimum</span></a></li></ul><a href="#configuration"><span>Configuration</span></a><ul><li><a href="#options-on-options"><span>Options on options</span></a></li><li><ul><li><a href="#matrix-options"><span>Matrix options</span></a></li><li><a href="#runtime-options"><span>Runtime options</span></a></li></ul></li></ul><a href="#drawing"><span>Drawing</span></a><ul><li><a href="#usage-patterns"><span>Usage <wbr/>Patterns</span></a></li><li><a href="#sync-hook"><span>Sync <wbr/>Hook</span></a></li></ul><a href="#running-examples"><span>Running <wbr/>Examples</span></a><a href="#api"><span>API</span></a><ul><li><ul><li><ul><li><a href="#configuration-option-enums"><span>Configuration option enums</span></a></li></ul></li><li><a href="#configuration-interfaces"><span>Configuration interfaces</span></a></li><li><ul><li><a href="#ledmatrixutils-1"><span>Led<wbr/>Matrix<wbr/>Utils</span></a></li><li><a href="#font-and-ledmatrix"><span>Font and <wbr/>Led<wbr/>Matrix</span></a></li><li><a href="#layoututils-1"><span>Layout<wbr/>Utils</span></a></li></ul></li></ul></li></ul><a href="#developing-locally"><span>Developing <wbr/>Locally</span></a></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="modules.html">rpi-led-matrix</a><ul class="tsd-small-nested-navigation" id="tsd-nav-container"><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>
